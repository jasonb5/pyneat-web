{% extends "base.html" %}

{% block breadcrumbs %}
{% with pop=spec.population %}
<li>
  <a href="{% url 'experiment' pop.experiment.pk %}">Experiment {{ pop.experiment.pk }}</a>
</li>
<li>
  <a href="{% url 'population' pop.pk %}">Population {{ pop.rel_index }}</a>
</li>
{% endwith %}
<li>
  <a href="{% url 'generation' spec.generation.pk %}">Generation {{ spec.generation.rel_index }}</a>
</li>
<li class="active">
  <a href="{% url 'species' spec.pk %}">Species {{ spec.rel_index }}</a>
</li>
{% endblock %}

{% block content %}
<div class="column-group">
  <div class="all-100">
    <form id="organism-form" action="" method="post">
      {% csrf_token %}
      <select id="organism-sel">
      {% for org in org_list %}
        <option value="{{ org.pk }}">Organism {{ org.rel_index }}</option>
      {% endfor %}
      </select>
      <input type="submit" value="Select" />
    </form>

    <table border="1">
    {% for k, v in fields.items %}
      <tr>
        <td>{{ k }}</td>
        <td>{{ v }}</td>
      </tr>
    {% endfor %}
    </table>
  </div>
</div>
<div class="column-group">
  <div class="all-50 medium-100">
    <div id="org-graph"></div>
  </div>
  <div class="all-50 medium-100">
    <div id="gen-graph"></div>
  </div>
</div>

<script type="text/javascript">
  var xdata = [];
  var ydata = [];

{% for org in org_fitness %}
  xdata.push({{ org.rel_index }});
  ydata.push({{ org.fitness }});
{% endfor %}

  var data = [
    {
      x: xdata,
      y: ydata,
      type: 'bar',
    }
  ];

  Plotly.newPlot('org-graph', data);

  var xdata = [];
  var ydata = [];

{% for gen in gen_fitness %}
  xdata.push({{ gen.generation__rel_index }});
  ydata.push({{ gen.avg_fitness }});
{% endfor %}

  var data = [
    {
      x: xdata,
      y: ydata,
      type: 'bar',
    }
  ];

  Plotly.newPlot('gen-graph', data);
</script>

{% endblock %}
